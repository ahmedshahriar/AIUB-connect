!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("ChatCamp",[],t):"object"==typeof exports?exports.ChatCamp=t():e.ChatCamp=t()}(window,function(){return function(e){var t={};function n(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){"use strict";var s=n(5),r=n(12),o=Object.prototype.toString;function a(e){return"[object Array]"===o.call(e)}function i(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===o.call(e)}function u(e,t){if(null!==e&&void 0!==e)if("object"!=typeof e&&(e=[e]),a(e))for(var n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:r,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:i,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:c,isStream:function(e){return i(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function n(n,s){"object"==typeof t[s]&&"object"==typeof n?t[s]=e(t[s],n):t[s]=n}for(var s=0,r=arguments.length;s<r;s++)u(arguments[s],n);return t},extend:function(e,t,n){return u(t,function(t,r){e[r]=n&&"function"==typeof t?s(t,n):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){e.exports=n(11)},function(e,t,n){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}();var o=n(31).LOG,a=o.DEBUG,i=o.INFO,c=o.WARN,u=o.ERROR,l=o.NONE,h=(Boolean(console.assert&&"".match(/assert/)),function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"log",value:function(e,t,n,r){"object"===(void 0===e?"undefined":s(e))&&(e,e="");(new Date).toLocaleTimeString();switch(n){case a:"debug";break;case i:"info";break;case c:"warn";break;case u:"error";break;default:"log"}}},{key:"debug",value:function(e,t){this.level>=a&&this.log(e,t,a,"#888")}},{key:"info",value:function(e,t){this.level>=i&&this.log(e,t,i,"black")}},{key:"warn",value:function(e,t){this.level>=c&&this.log(e,t,c,"orange")}},{key:"error",value:function(e,t){this.level>=u&&this.log(e,t,u,"red")}}]),e}());h.prototype.level="undefined"==typeof jasmine?u:l;var d=new h;e.exports=d},function(e,t,n){"use strict";(function(t){var s=n(0),r=n(15),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!s.isUndefined(e)&&s.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var i,c={adapter:("undefined"!=typeof XMLHttpRequest?i=n(6):void 0!==t&&(i=n(6)),i),transformRequest:[function(e,t){return r(t,"Content-Type"),s.isFormData(e)||s.isArrayBuffer(e)||s.isBuffer(e)||s.isStream(e)||s.isFile(e)||s.isBlob(e)?e:s.isArrayBufferView(e)?e.buffer:s.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):s.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},s.forEach(["delete","get","head"],function(e){c.headers[e]={}}),s.forEach(["post","put","patch"],function(e){c.headers[e]=s.merge(o)}),e.exports=c}).call(this,n(14))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=n(30),a=(s=o)&&s.__esModule?s:{default:s};t.default=function(e,t){var n=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=0;s<e;s++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},s=n(25)+(new Date).getTime(),o=0,i=1,c=2,u=3,l=e.replace("ws:","http:").replace("wss:","https:");e===l&&(void 0===t?t={disableWebSocket:!0}:t.disableWebSocket=!0);var h=function(e){if(this.readyState!==o&&this.readyState!==i)return!1;var t=this;return a.default.post(l,e,{iflychat_token:s,content_type:"application/json"},function(e){e&&0!==e.length&&t.onmessage({data:e})}),!0},d={websocket:function(){var e=null;return(void 0===t||!t.disableWebSocket)&&(window.WebSocket&&(e=window.WebSocket),window.MozWebSocket&&-1===navigator.userAgent.indexOf("Firefox/6.0")&&(e=window.MozWebSocket),e?{heart:!0,transport:e}:null)},eventsource:function(){if(void 0!==t&&t.disableEventSource)return!1;if(!window.EventSource)return!1;var e=new window.EventSource(l);e.onopen=function(){n.readyState=i,n.onopen()},e.onmessage=function(e){n.onmessage(e)},e.onerror=function(){e.close(),e=void 0,n.onerror()};var n={readyState:o,send:h,close:function(){n.readyState=u,e.close(),e=void 0,n.onclose()}};return{heart:!1,transport:function(){return n}}},xhrPolling:function(){if(void 0!==t&&t.disableXHRPolling)return!1;var e,c=null;s=n(25)+(new Date).getTime();var d={readyState:o,send:h,close:function(){this.readyState=u,c&&(c.abort(),c=null),clearTimeout(e),d.onclose()},onopen:function(){},onmessage:function(){},onerror:function(){},onclose:function(){}};function p(){e=setTimeout(function(){c=a.default.get(l,function(e){if(e){if(c=null,d.readyState===o&&(d.readyState=i,d.onopen(d)),e&&0!==e.length)if("object"===(void 0===e?"undefined":r(e)))for(var t in e)d.onmessage({data:e[t]});else d.onmessage({data:e});d.readyState===i&&p()}else c=null,d.onerror()},{iflychat_token:s})},100)}return p(),{heart:!1,transport:function(){return d}}}},p=0;var f=new function(){var t,n,s=!0,r=u,a=80,l=80,h=1e4,g=!1;!function _(){if(s=!1,r=o,!(n=g?null:function(){var t=0;for(var n in d){if(p===t){var s=d[n]();if(s){var r=new s.transport(e);return r.heart=s.heart,r}p++}t++}return!1}()))return a=l,p=0,f&&f.ondisconnect(),!1;n.onopen=function(){a=l,n.heart&&(t=setInterval(function(){f.onheartbeat()},2e4)),r!==i&&(r=i,f.onopen(),g=!0)},n.onclose=function(){s||r===u||(n=null,clearInterval(t),r===c?(r=u,n=!1,f.onclose()):(r===o&&p++,(a*=2)>h&&(a=h),s=!0,setTimeout(function(){_()},a)))},n.onerror=n.onclose,n.onmessage=function(e){f.onmessage(e)}}(),this.onopen=function(){},this.onmessage=function(){},this.ondisconnect=function(){},this.onclose=function(){},this.onheartbeat=function(){},this.setURL=function(t){e=t},this.send=function(e){if(n){var t=n.send(e);return void 0===t||t}return!1},this.close=function(){r=c,n&&n.close()},this.transportType=p};return f}},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),s=0;s<n.length;s++)n[s]=arguments[s];return e.apply(t,n)}}},function(e,t,n){"use strict";var s=n(0),r=n(16),o=n(18),a=n(19),i=n(20),c=n(7),u="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(21);e.exports=function(e){return new Promise(function(t,l){var h=e.data,d=e.headers;s.isFormData(h)&&delete d["Content-Type"];var p=new XMLHttpRequest,f="onreadystatechange",g=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in p||i(e.url)||(p=new window.XDomainRequest,f="onload",g=!0,p.onprogress=function(){},p.ontimeout=function(){}),e.auth){var _=e.auth.username||"",m=e.auth.password||"";d.Authorization="Basic "+u(_+":"+m)}if(p.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p[f]=function(){if(p&&(4===p.readyState||g)&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,s={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:1223===p.status?204:p.status,statusText:1223===p.status?"No Content":p.statusText,headers:n,config:e,request:p};r(t,l,s),p=null}},p.onerror=function(){l(c("Network Error",e,null,p)),p=null},p.ontimeout=function(){l(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",p)),p=null},s.isStandardBrowserEnv()){var I=n(22),C=(e.withCredentials||i(e.url))&&e.xsrfCookieName?I.read(e.xsrfCookieName):void 0;C&&(d[e.xsrfHeaderName]=C)}if("setRequestHeader"in p&&s.forEach(d,function(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)}),e.withCredentials&&(p.withCredentials=!0),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){p&&(p.abort(),l(e),p=null)}),void 0===h&&(h=null),p.send(h)})}},function(e,t,n){"use strict";var s=n(17);e.exports=function(e,t,n,r,o){var a=new Error(e);return s(a,t,n,r,o)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function s(e){this.message=e}s.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},s.prototype.__CANCEL__=!0,e.exports=s},function(e,t,n){"use strict";var s=n(32).default;e.exports=s},function(e,t,n){"use strict";var s=n(0),r=n(5),o=n(13),a=n(3);function i(e){var t=new o(e),n=r(o.prototype.request,t);return s.extend(n,o.prototype,t),s.extend(n,t),n}var c=i(a);c.Axios=o,c.create=function(e){return i(s.merge(a,e))},c.Cancel=n(9),c.CancelToken=n(28),c.isCancel=n(8),c.all=function(e){return Promise.all(e)},c.spread=n(29),e.exports=c,e.exports.default=c},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";var s=n(3),r=n(0),o=n(23),a=n(24);function i(e){this.defaults=e,this.interceptors={request:new o,response:new o}}i.prototype.request=function(e){"string"==typeof e&&(e=r.merge({url:arguments[0]},arguments[1])),(e=r.merge(s,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},r.forEach(["delete","get","head","options"],function(e){i.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}}),r.forEach(["post","put","patch"],function(e){i.prototype[e]=function(t,n,s){return this.request(r.merge(s||{},{method:e,url:t,data:n}))}}),e.exports=i},function(e,t){var n,s,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function i(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{s="function"==typeof clearTimeout?clearTimeout:a}catch(e){s=a}}();var c,u=[],l=!1,h=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&p())}function p(){if(!l){var e=i(d);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===a||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new f(e,t)),1!==u.length||l||i(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";var s=n(0);e.exports=function(e,t){s.forEach(e,function(n,s){s!==t&&s.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[s])})}},function(e,t,n){"use strict";var s=n(7);e.exports=function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(s("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,s,r){return e.config=t,n&&(e.code=n),e.request=s,e.response=r,e}},function(e,t,n){"use strict";var s=n(0);function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(s.isURLSearchParams(t))o=t.toString();else{var a=[];s.forEach(t,function(e,t){null!==e&&void 0!==e&&(s.isArray(e)?t+="[]":e=[e],s.forEach(e,function(e){s.isDate(e)?e=e.toISOString():s.isObject(e)&&(e=JSON.stringify(e)),a.push(r(t)+"="+r(e))}))}),o=a.join("&")}return o&&(e+=(-1===e.indexOf("?")?"?":"&")+o),e}},function(e,t,n){"use strict";var s=n(0),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,a={};return e?(s.forEach(e.split("\n"),function(e){if(o=e.indexOf(":"),t=s.trim(e.substr(0,o)).toLowerCase(),n=s.trim(e.substr(o+1)),t){if(a[t]&&r.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}}),a):a}},function(e,t,n){"use strict";var s=n(0);e.exports=s.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var s=e;return t&&(n.setAttribute("href",s),s=n.href),n.setAttribute("href",s),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=s.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r(){this.message="String contains an invalid character"}r.prototype=new Error,r.prototype.code=5,r.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,n,o=String(e),a="",i=0,c=s;o.charAt(0|i)||(c="=",i%1);a+=c.charAt(63&t>>8-i%1*8)){if((n=o.charCodeAt(i+=.75))>255)throw new r;t=t<<8|n}return a}},function(e,t,n){"use strict";var s=n(0);e.exports=s.isStandardBrowserEnv()?{write:function(e,t,n,r,o,a){var i=[];i.push(e+"="+encodeURIComponent(t)),s.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),s.isString(r)&&i.push("path="+r),s.isString(o)&&i.push("domain="+o),!0===a&&i.push("secure"),document.cookie=i.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var s=n(0);function r(){this.handlers=[]}r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){s.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,n){"use strict";var s=n(0),r=n(25),o=n(8),a=n(3),i=n(26),c=n(27);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!i(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=r(e.data,e.headers,e.transformRequest),e.headers=s.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),s.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||a.adapter)(e).then(function(t){return u(e),t.data=r(t.data,t.headers,e.transformResponse),t},function(t){return o(t)||(u(e),t&&t.response&&(t.response.data=r(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var s=n(0);e.exports=function(e,t,n){return s.forEach(n,function(n){e=n(e,t)}),e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var s=n(9);function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new s(e),t(n.reason))})}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r(function(t){e=t}),cancel:e}},e.exports=r},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");return!!(t>0||navigator.userAgent.match(/Trident.*rv\:11\./))&&parseInt(e.substring(t+5,e.indexOf(".",t)))};e.exports={post:function(e,t,n,o){var a=!1;r()&&window.XDomainRequest;var i=new XMLHttpRequest;i.open("POST",e,!0),i.withCredentials=!0,"application/x-www-form-urlencoded"===n?i.setRequestHeader("Content-type",n):"object"===(void 0===n?"undefined":s(n))?(i.setRequestHeader("Content-type",n.content_type),i.setRequestHeader("X-CSRF-TOKEN",n.csrf_token),n.access_token&&i.setRequestHeader("X-Access-Token",n.access_token),n.iflychat_token&&i.setRequestHeader("iflychat-token",n.iflychat_token),"string"!=typeof t&&"application/json"===n.content_type&&(t=JSON.stringify(t))):(i.setRequestHeader("Content-type","application/json"),"string"!=typeof t&&(t=JSON.stringify(t))),i.ontimeout=function(){a||(a=!0,o(!1))},i.timeout=5e4,i.onerror=function(){a||(a=!0,o(!1))},i.send(t),i.onreadystatechange=function(){if(4===i.readyState&&i.status>=200&&i.status<300)try{var e=JSON.parse(i.responseText);a||(a=!0,o(e))}catch(e){a||(a=!0,o("invalidTokenJSON"))}else 4===i.readyState&&(a||(a=!0,o(!1)))},i.onloadend=function(){}},get:function(e,t,n){var o=!1;r()&&window.XDomainRequest;var a=new XMLHttpRequest;a.open("GET",e),a.withCredentials=!0,"object"===(void 0===n?"undefined":s(n))&&(n.iflychat_token&&a.setRequestHeader("iflychat-token",n.iflychat_token),a.setRequestHeader("x-csrf-token",n.csrf_token)),a.ontimeout=function(){o||(o=!0,t(!1))},a.onerror=function(){o||(o=!0,t(!1))},a.timeout=2e5,a.send(),a.onreadystatechange=function(){if(4===a.readyState&&a.status>=200&&a.status<300){var e=JSON.parse(a.responseText);o=!0,t(e)}else 4===a.readyState&&(o||(o=!0,t(!1)))},a.onloadend=function(){}}}},function(e,t,n){"use strict";e.exports={SYNC_STATE:{NEW:"NEW",SAVING:"SAVING",SYNCING:"SYNCING",SYNCED:"SYNCED",LOADING:"LOADING"},RECIPIENT_STATE:{NONE:"NONE",SOME:"SOME",ALL:"ALL"},RECEIPT_STATE:{SENT:"sent",DELIVERED:"delivered",READ:"read",PENDING:"pending"},LOCALSTORAGE_KEYS:{SESSIONDATA:"iflychat-session-data-"},ACCEPT:"application/vnd.iflychat+json; version=2.0",WEBSOCKET_PROTOCOL:"iflychat-2.0",LOG:{DEBUG:4,INFO:3,WARN:2,ERROR:1,NONE:0},DELETION_MODE:{ALL:"all_participants",MY_DEVICES:"my_devices"},TYPING_STATE:{STARTED:"started",PAUSED:"paused",FINISHED:"finished"}}},function(e,t,n){"use strict";n.r(t);class s{constructor(e){this.events={}}on(e,t){(this.events[e]||(this.events[e]=[])).push(t)}off(e,t){this.events[e]&&this.events[e].splice(this.events[e].indexOf(t)>>>0,1)}emit(e,t){(this.events[e]||[]).slice().map(e=>{e(t)}),(this.events["*"]||[]).slice().map(n=>{n(e,t)})}}var r,o,a,i=n(1),c=n.n(i);class u{constructor(e){e.appId&&(this.id=e.appId),e.id&&(this.id=e.id),e.name&&(this.name=e.name)}}class l{constructor(e){this.avatarUploadUrl="",this.id="",this.displayName="",this.firstName="",this.lastName="",this.email="",this.phoneNumber="",this.profileUrl="",this.avatarUrl="",this.lastSeen=0,this.isSuspended=!1,this.checkAccessToken=!1,this.data="",this.metadata={},e.id&&(this.id=e.id),e.display_name&&(this.displayName=e.display_name),e.first_name&&(this.firstName=e.first_name),e.last_name&&(this.lastName=e.last_name),e.email&&(this.email=e.email),e.phone_number&&(this.phoneNumber=e.phone_number),e.profile_url&&(this.profileUrl=e.profile_url),e.avatar_url&&(this.avatarUrl=e.avatar_url),e.avatar_upload_url&&(this.avatarUploadUrl=e.avatar_upload_url),e.last_seen?this.lastSeen=e.last_seen:this.lastSeen=0,e.is_suspended&&(this.isSuspended=e.is_suspended),e.check_access_token&&(this.checkAccessToken=e.check_access_token),e.access_token&&(this.accessToken=e.access_token),e.metadata&&(this.metadata=e.metadata),e.is_online?this.isOnline=e.is_online:this.isOnline=!1,e.data&&(this.data=e.data)}getId(){return this.id}getDisplayName(){return this.displayName}getData(){return this.data}}class h{constructor(e){this.id=e.id,this.type=e.type,"attachment"===e.type?this.attachment=e.attachment:this.text=e.text,e.custom_filter?this.customFilter=e.custom_filter:this.customFilter=[],e.metadata?this.metadata=e.metadata:this.metadata={},this.user=new l(e.user),this.insertedAt=e.inserted_at}getText(){return this.text}getUser(){return this.user}}class d{constructor(){}setCustomFilter(e){this.customFilter=e}setData(e){this.data=e}setMetadata(e){this.metadata=e}setText(e){this.text=e}getCustomFilter(){return this.customFilter}getData(){return this.data}getMetadata(){return this.metadata}getText(){return this.text}}class p{constructor(e){this.code=e.code,this.message=e.message}getMessage(){return this.message}getCode(){return this.code}}!function(e){e.PARTICIPANT_STATE_ALL="ALL",e.PARTICIPANT_STATE_INVITED="INVITED",e.PARTICIPANT_STATE_ACCEPTED="ACCEPTED",e.RECENT_CHAT="RECENT_CHAT",e.CHRONOLOGICAL="CHRONOLOGICAL",e.ALPHABETICAL="ALPHABETICAL",e.QUERY_TYPE_AND="AND",e.QUERY_TYPE_OR="OR"}(r||(r={}));class f{constructor(){this.participantStateFilter=r.PARTICIPANT_STATE_ALL,this.limit=20,this.order=r.RECENT_CHAT}setLimit(e){this.limit=e}setReference(e){this.reference=e}setParticipantState(e){this.participantStateFilter=e}load(e){let t=x.getInstance().transportManager.send({t:"group_channels.my_list",d:{participant_state_filter:this.participantStateFilter,reference:this.reference,limit:this.limit,order:this.order,custom_filter:this.customFilter,custom_filter_query_type:this.customFilterQueryType,custom_filter_search:this.customFilterSearch,channel_ids_filter:this.channelIdsFilter,channel_name_search:this.channelNameSearch,user_ids_all_filter:this.userIdsAllFilter,user_ids_filter_search:this.userIdsFilterSearch,user_ids_filter_search_query_type:this.userIdsFilterSearchQueryType,user_name_search:this.userNameSearch}}),n=r=>(window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(null,r)),s=r=>{let o=new p(r);return window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(o,null)};return x.getInstance().on("to."+t+".success",n),x.getInstance().on("to."+t+".error",s),!0}}!function(e){e.SORT_BY_INSERTED_AT="INSERTED_AT",e.SORT_BY_UPDATED_AT="UPDATED_AT"}(o||(o={}));class g{constructor(e){this.limit=20,this.channel=e,this.sortBy=o.SORT_BY_INSERTED_AT}setLimit(e){this.limit=e}setReference(e){this.reference=e}setSortBy(e){this.sortBy=e}load(e){let t;t=x.getInstance().transportManager.send({t:this.channel.getType()+"_channels.history",d:{id:this.channel.getId(),limit:this.limit,reference:this.reference,sort_by:this.sortBy}});let n=r=>(window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(null,r)),s=r=>{let o=new p(r);return window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(o,null)};return x.getInstance().on("to."+t+".success",n),x.getInstance().on("to."+t+".error",s),!0}}class _ extends l{constructor(e){super(e),this.isBlockedByMe=!1,this.isBlockingMe=!1,e.status&&(this.status=e.status),e.is_blocked_by_me&&(this.isBlockedByMe=e.is_blocked_by_me),e.is_blocking_me&&(this.isBlockingMe=e.is_blocking_me)}getInvitationState(){}}!function(e){e.OPEN="open",e.GROUP="group"}(a||(a={}));class m{constructor(e){this.customFilter=[],e.id&&(this.id=e.id),e.name&&(this.name=e.name),e.data&&(this.data=e.data),e.avatar_url&&(this.avatarUrl=e.avatar_url),e.metadata&&(this.metadata=e.metadata),e.updated_at&&(this.updatedAt=e.updated_at),e.inserted_at&&(this.insertedAt=e.inserted_at),e.custom_filter&&(this.customFilter=e.custom_filter)}getType(){return this.isGroupChannel()?a.GROUP:a.OPEN}getCustomFilter(){return this.customFilter}isGroupChannel(){return this instanceof C}isOpenChannel(){return!this.isGroupChannel()}getId(){return this.id}sendMessage(e,t,n,s){return s?this._sendMessage({message:e,metadata:t,customFilter:n},s):n?this._sendMessage({message:e,metadata:t},n):!!t&&this._sendMessage({message:e},t)}_sendMessage(e,t){let n={id:this.id,text:e.message,type:"text"};e.metadata&&(n.metadata=e.metadata),e.customFilter&&(n.custom_filter=e.customFilter);let s=x.getInstance().transportManager.send({t:this.getType()+"_channels.message",d:n}),r=e=>(window.setTimeout(()=>{x.getInstance().off("to."+s+".success",r),x.getInstance().off("to."+s+".error",o)},0),t(null,e)),o=e=>{let n=new p(e);return window.setTimeout(()=>{x.getInstance().off("to."+s+".success",r),x.getInstance().off("to."+s+".error",o)},0),t(n,null)};return x.getInstance().on("to."+s+".success",r),x.getInstance().on("to."+s+".error",o),!0}sendAttachment(e,t,n){x.getInstance()._uploadAttachment(e,this.getType()+"_channel",this.id,t,(e,t)=>{if(e)return n(e,null);let s=x.getInstance().transportManager.send({t:this.getType()+"_channels.message",d:{id:this.id,type:"attachment",attachment:t}}),r=e=>(window.setTimeout(()=>{x.getInstance().off("to."+s+".success",r),x.getInstance().off("to."+s+".error",o)},0),n(null,e)),o=e=>{let t=new p(e);return window.setTimeout(()=>{x.getInstance().off("to."+s+".success",r),x.getInstance().off("to."+s+".error",o)},0),n(t,null)};return x.getInstance().on("to."+s+".success",r),x.getInstance().on("to."+s+".error",o),!0})}updateMetadata(e,t){let n=x.getInstance().transportManager.send({t:this.getType()+"_channels.update",d:{id:this.id,metadata:e}}),s=e=>(window.setTimeout(()=>{x.getInstance().off("to."+n+".success",s),x.getInstance().off("to."+n+".error",r)},0),t(null,e)),r=e=>{let o=new p(e);return window.setTimeout(()=>{x.getInstance().off("to."+n+".success",s),x.getInstance().off("to."+n+".error",r)},0),t(o,null)};x.getInstance().on("to."+n+".success",s),x.getInstance().on("to."+n+".error",r)}updateMessage(e,t,n){let s={id:this.id,message_id:e};t.getCustomFilter()&&(s.custom_filter=t.getCustomFilter()),t.getData()&&(s.data=t.getData()),t.getMetadata()&&(s.metadata=t.getMetadata()),t.getText()&&(s.text=t.getText());let r=x.getInstance().transportManager.send({t:this.getType()+"_channels.message_update",d:s}),o=e=>(window.setTimeout(()=>{x.getInstance().off("to."+r+".success",o),x.getInstance().off("to."+r+".error",a)},0),n(null,e)),a=e=>{let t=new p(e);return window.setTimeout(()=>{x.getInstance().off("to."+r+".success",o),x.getInstance().off("to."+r+".error",a)},0),n(t,null)};x.getInstance().on("to."+r+".success",o),x.getInstance().on("to."+r+".error",a)}}class I{constructor(){this.customFilter=[],this.customFilterQueryType="OR"}setCustomFilter(e){this.customFilter=e}setCustomFilterQueryType(e){this.customFilterQueryType=e}getCustomFilter(){return this.customFilter}getCustomFilterQueryType(){return this.customFilterQueryType}}class C extends m{constructor(e){if(super(e),this.unreadMessageCount=0,e.participants){this.participants=[];for(let t in e.participants)this.participants.push(new _(e.participants[t]))}e.participants_count?this.participantsCount=e.participants_count:this.participantsCount=0,e.unread_message_count?this.unreadMessageCount=e.unread_message_count:this.unreadMessageCount=0,e.last_message&&(this.lastMessage=new h(e.last_message)),e.is_distinct?this.isDistinct=e.is_distinct:this.isDistinct=!1,e.read_receipt&&(this.readReceipt=e.read_receipt),e.is_archive&&(this.isArchive=e.isArchive),this.cachedParticipantsTypingStatus={},this.lastStartTyping=0,this.lastStopTyping=0}static create(){4==arguments.length?"string"==typeof arguments[0]&&"object"==typeof arguments[1]&&(arguments[2],1)&&(arguments[3],1)&&this._create4(arguments[0],arguments[1],arguments[2],arguments[3]):5===arguments.length&&"string"==typeof arguments[0]&&"object"==typeof arguments[1]&&(arguments[2],1)&&"object"==typeof arguments[1]&&(arguments[4],1)&&this._create5(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4])}static _create4(e,t,n,s){let r=x.getInstance().transportManager.send({t:"group_channels.create",d:{name:e,participant_ids:t,is_distinct:n}}),o=e=>(window.setTimeout(()=>{x.getInstance().off("to."+r+".success",o),x.getInstance().off("to."+r+".error",a)},0),s(null,e)),a=e=>{let t=new p(e);return window.setTimeout(()=>{x.getInstance().off("to."+r+".success",o),x.getInstance().off("to."+r+".error",a)},0),s(t,null)};return x.getInstance().on("to."+r+".success",o),x.getInstance().on("to."+r+".error",a),!0}static _create5(e,t,n,s,r){let o=x.getInstance().transportManager.send({t:"group_channels.create",d:{name:e,participant_ids:t,is_distinct:n,custom_filter:s}}),a=e=>(window.setTimeout(()=>{x.getInstance().off("to."+o+".success",a),x.getInstance().off("to."+o+".error",i)},0),r(null,e)),i=e=>{let t=new p(e);return window.setTimeout(()=>{x.getInstance().off("to."+o+".success",a),x.getInstance().off("to."+o+".error",i)},0),r(t,null)};return x.getInstance().on("to."+o+".success",a),x.getInstance().on("to."+o+".error",i),!0}static _upsert(e){let t=new C(e);C.cachedChannels[t.getId()]=t}static get(e,t){return C.cachedChannels&&C.cachedChannels[e]?t(null,C.cachedChannels[e]):this._getFromServer(e,t)}static _getFromServer(e,t){let n=x.getInstance().transportManager.send({t:"group_channels.get",d:{id:e}}),s=e=>(window.setTimeout(()=>{x.getInstance().off("to."+n+".success",s),x.getInstance().off("to."+n+".error",r)},0),t(null,e)),r=e=>{let o=new p(e);return window.setTimeout(()=>{x.getInstance().off("to."+n+".success",s),x.getInstance().off("to."+n+".error",r)},0),t(o,null)};x.getInstance().on("to."+n+".success",s),x.getInstance().on("to."+n+".error",r)}updatePushNotificationPreference(e,t,n,s,r,o,a){x.getInstance()._updatePushNotificationPreference({doNotDisturb:e,startHour:t,startMin:n,endHour:s,endMin:r,timezone:o,groupChannelId:this.id},a)}getPushNotificationPreference(e){x.getInstance()._getPushNotificationPreference({groupChannelId:this.id},e)}sync(e){let t=x.getInstance().transportManager.send({t:"group_channels.get",d:{id:this.id}}),n=r=>(window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(null,r)),s=r=>{let o=new p(r);return window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(o,null)};return x.getInstance().on("to."+t+".success",n),x.getInstance().on("to."+t+".error",s),!0}inviteParticipants(e,t){let n=x.getInstance().transportManager.send({t:"group_channels.invite",d:{id:this.id,participant_ids:e}}),s=e=>(window.setTimeout(()=>{x.getInstance().off("to."+n+".success",s),x.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new p(e);return window.setTimeout(()=>{x.getInstance().off("to."+n+".success",s),x.getInstance().off("to."+n+".error",r)},0),t(e)};return x.getInstance().on("to."+n+".success",s),x.getInstance().on("to."+n+".error",r),!0}inviteParticipant(e,t){return this.inviteParticipants([e],t)}acceptInvitation(e){let t=x.getInstance().transportManager.send({t:"group_channels.accept",d:{id:this.id}}),n=r=>(window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new p(r);return window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(r)};return x.getInstance().on("to."+t+".success",n),x.getInstance().on("to."+t+".error",s),!0}leave(e){let t=x.getInstance().transportManager.send({t:"group_channels.leave",d:{id:this.id}}),n=r=>(window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new p(r);return window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(r)};return x.getInstance().on("to."+t+".success",n),x.getInstance().on("to."+t+".error",s),!0}declineInvitation(e){let t=x.getInstance().transportManager.send({t:"group_channels.decline",d:{id:this.id}}),n=r=>(window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new p(r);return window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(r)};return x.getInstance().on("to."+t+".success",n),x.getInstance().on("to."+t+".error",s),!0}isTyping(){return Object.keys(this.cachedParticipantsTypingStatus).length>0}setTypingStatus(e,t){t?this.cachedParticipantsTypingStatus[e]=(new Date).getTime():delete this.cachedParticipantsTypingStatus[e]}checkTypingStatus(){let e=!1;for(let t in this.cachedParticipantsTypingStatus)this.cachedParticipantsTypingStatus[t]<(new Date).getTime()-1e4&&(delete this.cachedParticipantsTypingStatus[t],e=!0);return e}startTyping(){if(this.lastStartTyping<(new Date).getTime()-1e4){x.getInstance().transportManager.send({t:"group_channels.start_typing",d:{id:this.id}});return this.lastStartTyping=(new Date).getTime(),!0}}stopTyping(){if(this.lastStopTyping<(new Date).getTime()-1e4){x.getInstance().transportManager.send({t:"group_channels.stop_typing",d:{id:this.id}});return this.lastStopTyping=(new Date).getTime(),!0}}markAsRead(){return this.getCurrentUserReadStatus()||this._markAsRead(),!0}_markAsRead(){x.getInstance().transportManager.send({t:"group_channels.read",d:{id:this.id}});return!0}getReadReceipt(e){return this.readReceipt}getUnreadMessageCount(){return this.unreadMessageCount}getCurrentUserReadStatus(){if(this.lastMessage){let e=this.lastMessage.insertedAt;return this.readReceipt[x.getInstance().user.id]>=e}return!0}getTypingParticipants(){let e=[];for(let t in this.cachedParticipantsTypingStatus)for(let n in this.participants)if(t===this.participants[n].id){e.push(this.participants[n]);break}return e}getId(){return this.id}getName(){return this.name}static createGroupChannelListQuery(){return new f}createPreviousMessageListQuery(){return new g(this)}static purgeCache(){C.cachedChannels={}}static getTotalGroupChannelCount(e,t){"object"==typeof t?C._getTotalGroupChannelCount(e,t):C._getTotalGroupChannelCount(new I,e)}static _getTotalGroupChannelCount(e,t){let n={custom_filter_query_type:e.getCustomFilterQueryType()};e.getCustomFilter().length&&(n.custom_filter=e.getCustomFilter());let s=x.getInstance().transportManager.send({t:"group_channels.my_list_count",d:n}),r=n=>{let a=e.getCustomFilter().join("")+e.getCustomFilterQueryType();return C.cachedTotalGroupChannelCount[a]={count:n,params:e},window.setTimeout(()=>{x.getInstance().off("to."+s+".success",r),x.getInstance().off("to."+s+".error",o)},0),t(null,n,e)},o=e=>{new p(e);return window.setTimeout(()=>{x.getInstance().off("to."+s+".success",r),x.getInstance().off("to."+s+".error",o)},0),t(e,null,null)};return x.getInstance().on("to."+s+".success",r),x.getInstance().on("to."+s+".error",o),!0}}C.cachedChannels={},C.cachedTotalGroupChannelCount={};class T{constructor(){this.onOpenChannelMessageReceived=function(e,t){},this.onOpenChannelMessageUpdated=function(e,t){},this.onOpenChannelParticipantJoined=function(e,t){},this.onOpenChannelParticipantLeft=function(e,t){},this.onGroupChannelMessageReceived=function(e,t){},this.onGroupChannelMessageUpdated=function(e,t){},this.onGroupChannelTypingStatusChanged=function(e){},this.onGroupChannelReadStatusUpdated=function(e){},this.onGroupChannelUpdated=function(e){},this.onGroupChannelParticipantJoined=function(e,t){},this.onGroupChannelParticipantLeft=function(e,t){},this.onGroupChannelParticipantInvited=function(e,t){},this.onGroupChannelParticipantDeclined=function(e,t){},this.onTotalGroupChannelCount=((e,t)=>{})}}class w{constructor(){this.onConnectionChanged=function(e){}}}class y{constructor(){this.onTotalUnreadMessageCount=((e,t)=>{}),this.onTotalUnreadGroupChannelCount=((e,t)=>{})}}var k,b,v=class{constructor(){this.limit=20}setLimit(e){this.limit=e}setReference(e){this.reference=e}load(e){let t=x.getInstance().transportManager.send({t:"open_channels.list",d:{reference:this.reference,limit:this.limit}}),n=r=>(window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(null,r)),s=r=>{let o=new p(r);return window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(o,null)};return x.getInstance().on("to."+t+".success",n),x.getInstance().on("to."+t+".error",s),!0}};!function(e){e.IS_ACTIVE_FILTER_ACTIVE="ACTIVE",e.IS_ACTIVE_FILTER_DEACTIVE="DEACTIVE",e.IS_ACTIVE_FILTER_ALL="ALL",e.IS_ONLINE_FILTER_ONLINE="ONLINE",e.IS_ONLINE_FILTER_OFFLINE="OFFLINE",e.IS_ONLINE_FILTER_ALL="ALL",e.ORDER_CHRONOLOGICAL="CHRONOLOGICAL",e.ORDER_ALPHABETICAL="ALPHABETICAL"}(k||(k={})),function(e){e.BLOCKED_USER="BLOCKED_USER",e.ALL_USER="ALL_USER"}(b||(b={}));class A{constructor(e){this.type=e,this.limit=20,this.isActiveFilter=k.IS_ACTIVE_FILTER_ACTIVE,this.isOnlineFilter=k.IS_ONLINE_FILTER_ALL,this.order=k.ORDER_ALPHABETICAL}setLimit(e){this.limit=e}setReference(e){this.reference=e}load(e){let t;this.type===b.ALL_USER?t=x.getInstance().transportManager.send({t:"users.list",d:{limit:this.limit,reference:this.reference,user_ids:this.userIds,is_active_filter:this.isActiveFilter,is_online_filter:this.isOnlineFilter,custom_filter:this.customFilter,custom_filter_query_type:this.customFilterQueryType,display_name_search:this.displayNameSearch,order:this.order}}):this.type===b.BLOCKED_USER&&(t=x.getInstance().transportManager.send({t:"users.block_list",d:{limit:this.limit,reference:this.reference}}));let n=r=>(window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),r.length>0&&(this.reference=r[r.length-1].id),e(null,r)),s=r=>{let o=new p(r);return window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(o,null)};return x.getInstance().on("to."+t+".success",n),x.getInstance().on("to."+t+".error",s),!0}}class S extends m{static get(e,t){return S.cachedChannels&&S.cachedChannels[e]?t(null,S.cachedChannels[e]):this._getFromServer(e,t)}static _getFromServer(e,t){let n=x.getInstance().transportManager.send({t:"open_channels.get",d:{id:e}}),s=e=>(window.setTimeout(()=>{x.getInstance().off("to."+n+".success",s),x.getInstance().off("to."+n+".error",r)},0),t(null,e)),r=e=>{let o=new p(e);return window.setTimeout(()=>{x.getInstance().off("to."+n+".success",s),x.getInstance().off("to."+n+".error",r)},0),t(o,null)};x.getInstance().on("to."+n+".success",s),x.getInstance().on("to."+n+".error",r)}static _upsert(e){let t=new S(e);S.cachedChannels||(S.cachedChannels={}),S.cachedChannels[t.getId()]=t}join(e){let t=x.getInstance().transportManager.send({t:"open_channels.join",d:{id:this.id}}),n=r=>(window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new p(r);return window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(r)};return x.getInstance().on("to."+t+".success",n),x.getInstance().on("to."+t+".error",s),!0}leave(e){let t=x.getInstance().transportManager.send({t:"open_channels.leave",d:{id:this.id}}),n=r=>(window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new p(r);return window.setTimeout(()=>{x.getInstance().off("to."+t+".success",n),x.getInstance().off("to."+t+".error",s)},0),e(r)};return x.getInstance().on("to."+t+".success",n),x.getInstance().on("to."+t+".error",s),!0}constructor(e){if(super(e),e.participants){this.participants=[];for(let t in e.participants)this.participants.push(new _(e.participants[t]))}e.participants_count?this.participantsCount=e.participants_count:this.participantsCount=0}getId(){return this.id}getName(){return this.name}static createOpenChannelListQuery(){return new v}createPreviousMessageListQuery(){return new g(this)}static purgeCache(){S.cachedChannels={}}}var U,L=n(4),M=n.n(L),E=n(2),O=n.n(E);!function(e){e.HOST="wss://api.chatcamp.io",e.PORT="443"}(U||(U={}));var P=class extends s{constructor(e){super(e),this.client=e.client,this.heartbeatFrequency=6e4,this._nextHeartbeatId=0,this.open=!1,this.timesOpened=0,this._reconnectDelay=1,this._maxReconnectDelay=120,this._listeners={},this.host=U.HOST,this.port=U.PORT,e.host&&(this.host=e.host),e.port&&(this.port=e.port),this._r=0}_connect(e){this.accessToken=e.accessToken,this.userId=e.userId;let t=U.HOST;this.host!==U.HOST&&(t=this.host+":"+this.port),e.accessToken?this._socket=new M.a(t+"/chat/1.0?app_id="+this.client.app.id+"&user_id="+encodeURIComponent(e.userId)+"&access_token="+encodeURIComponent(e.accessToken),{disableWebSocket:!1,disableEventSource:!0,disableXHRPolling:!1}):this._socket=new M.a(t+"/chat/1.0?app_id="+this.client.app.id+"&user_id="+encodeURIComponent(e.userId),{disableWebSocket:!1,disableEventSource:!0,disableXHRPolling:!1}),this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onDisconnect.bind(this),this._socket.ondisconnect=this._onDisconnect.bind(this),this._socket.onopen=this._onOpen.bind(this),this._socket.onerror=this._onError.bind(this),x.getInstance().setConnectionState(R.CONNECTING)}setHost(e){this.host=e}setPort(e){this.port=e}_onOpen(){O.a.debug("chat socket: opened",this._socket.transportType),this.open=!0,this.timesOpened++,this._rescheduleHeartbeat(),this.emit("open",null)}_onMessage(e){this._reconnectDelay=1,O.a.debug("chat socket: message",typeof e);let t=JSON.parse(e.data);this.emit("message",t),O.a.debug(t)}_onDisconnect(){this.open=!1,this.emit("close",null);let e=this;x.getInstance().setConnectionState(R.CLOSED),C.purgeCache(),S.purgeCache();let t=x.getInstance().getConnectionListenersMap();for(let e in t)t[e].onConnectionChanged(!1);setTimeout(function(){e._reconnectDelay<=e._maxReconnectDelay&&(e._reconnectDelay=2*e._reconnectDelay),e._reconnect()},this._reconnectDelay>this._maxReconnectDelay?1e3*this._maxReconnectDelay:1e3*this._reconnectDelay)}_onHeartbeat(){this.send({t:"ping"})}_onClose(){}_onError(e){let t="iflychat.app.ws.error";0!==this._socket.transportType&&(t="iflychat.app.poll.error")}send(e){return this._r++,e.r=this._r,e.l&&(this._listeners["r_"+e.r]=e.l,delete e.l),this.open&&this._socket.send(JSON.stringify(e)),this._r}_rescheduleHeartbeat(){this._nextHeartbeatId&&clearTimeout(this._nextHeartbeatId),this._nextHeartbeatId=setTimeout(this._heartbeat.bind(this),this.heartbeatFrequency)}_heartbeat(){this._nextHeartbeatId=0,this.send({t:"ping"}),this._rescheduleHeartbeat()}_reconnect(){if(this._socket=null,this.open=!1,clearTimeout(this._nextHeartbeatId),x.getInstance().setConnectionState(R.CLOSED),!this.client.hasUserForcedDisconnect()&&this.client.isAutoReconnectEnabled()){let e,t=null;if(this.client.user&&this.client.user.accessToken&&this.client.user.id?(t=this.client.user.accessToken,e=this.client.user.id):this.client.user&&this.client.user.id?e=this.client.user.id:this.userId&&this.accessToken?(t=this.accessToken,e=this.userId):this.userId&&(e=this.userId),e&&t)return this._connect({userId:e,accessToken:t}),!0;if(e)return this._connect({userId:e}),!0}return!1}disconnect(e){x.getInstance().setConnectionState(R.CLOSING),this._socket&&this._socket.close(1e3,"Normal Closure"),e()}};var N,R,G=class extends s{constructor(e,t){super(),x.getInstance().transportManager.on("message",this._handleMessage.bind(this))}_handleMessage(e){switch(e.t){case"app.get.ack":this._handleAppInfo(e);break;case"group_channels.create.ack":this._handleGroupChannelCreateAck(e.d,e.to);break;case"group_channels.history.ack":this._handleGroupChannelHistoryAck(e.d,e.to);break;case"group_channels.get.ack":this._handleGroupChannelGetAck(e.d,e.to);break;case"group_channels.update.ack":this._handleGroupChannelCreateAck(e.d,e.to);break;case"group_channels.update.pub":this._handleGroupChannelUpdatePub(e.d);break;case"group_channels.invite.ack":this._handleGroupChannelInviteAck(e.d,e.to);break;case"group_channels.accept.ack":this._handleGroupChannelAcceptAck(e.d,e.to);break;case"group_channels.invite.pub":this._handleGroupChannelInvitePub(e.d);break;case"group_channels.accept.pub":this._handleGroupChannelAcceptPub(e.d);break;case"group_channels.decline.ack":this._handleGroupChannelDeclineAck(e.d,e.to);break;case"group_channels.decline.pub":this._handleGroupChannelDeclinePub(e.d);break;case"group_channels.leave.ack":this._handleGroupChannelLeaveAck(e.d,e.to);break;case"group_channels.leave.pub":this._handleGroupChannelLeavePub(e.d);break;case"group_channels.my_list.ack":this._handleGroupChannelMyListAck(e.d,e.to);break;case"group_channels.my_list_count.ack":this._handleGroupChannelsMyListCountAck(e.d,e.to);break;case"group_channels.message.ack":this._handleGroupChannelMessageAck(e.d,e.to);break;case"group_channels.message.pub":this._handleGroupChannelMessagePub(e.d,e.to);break;case"group_channels.message_update.ack":this._handleGroupChannelMessageUpdateAck(e.d,e.to);break;case"group_channels.message_update.pub":this._handleGroupChannelMessageUpdatePub(e.d,e.to);break;case"group_channels.start_typing.pub":this._handleGroupChannelStartTypingPub(e.d,e.to);break;case"group_channels.start_typing.ack":break;case"group_channels.stop_typing.pub":this._handleGroupChannelStopTypingPub(e.d,e.to);break;case"group_channels.stop_typing.ack":break;case"group_channels.read.ack":this._handleGroupChannelReadAck(e.d,e.to);break;case"group_channels.read.pub":this._handleGroupChannelReadPub(e.d);break;case"open_channels.get.ack":this._handleOpenChannelGetAck(e.d,e.to);break;case"open_channels.history.ack":this._handleOpenChannelHistoryAck(e.d,e.to);break;case"open_channels.join.ack":this._handleOpenChannelJoinAck(e.d,e.to);break;case"open_channels.join.pub":this._handleOpenChannelJoinPub(e.d,e.to);break;case"open_channels.leave.ack":this._handleOpenChannelLeaveAck(e.d,e.to);break;case"open_channels.leave.pub":this._handleOpenChannelLeavePub(e.d,e.to);break;case"open_channels.list.ack":this._handleOpenChannelListAck(e.d,e.to);break;case"open_channels.message.ack":this._handleOpenChannelMessageAck(e.d,e.to);break;case"open_channels.message.pub":this._handleOpenChannelMessagePub(e.d,e.to);break;case"open_channels.message_update.ack":this._handleOpenChannelMessageUpdateAck(e.d,e.to);break;case"open_channels.message_update.pub":this._handleOpenChannelMessageUpdatePub(e.d,e.to);break;case"users.auth.ack":this._handleUsersAuthAck(e.d,e.to);break;case"users.get.ack":case"users.update.ack":this._handleUsersUpdateAck(e.d,e.to);break;case"users.block_list.ack":this._handleUsersBlockListAck(e.d,e.to);break;case"users.list.ack":this._handleUsersListAck(e.d,e.to);break;case"users.block.ack":this._handleUsersBlockAck(e.d,e.to);break;case"users.get_total_unread_message_count.ack":this._handleUsersGetTotalUnreadMessageCountAck(e.d,e.to);break;case"users.get_total_unread_group_channel_count.ack":this._handleUsersGetTotalUnreadGroupChannelCountAck(e.d,e.to);break;case"users.mark_as_read_all.ack":this._handleUsersMarkAsReadAllAck(e.d,e.to);break;case"users.push_notification_snooze_get.ack":this._handleUsersPushNotificationSnoozeGetAck(e.d,e.to);break;case"users.push_notification_snooze_update.ack":this._handleUsersPushNotificationSnoozeUpdateAck(e.d,e.to);break;case"users.push_notification_sound_get.ack":this._handleUsersPushNotificationSoundGetAck(e.d,e.to);break;case"users.push_notification_sound_update.ack":this._handleUsersPushNotificationSoundUpdateAck(e.d,e.to);break;case"users.push_notification_template_get.ack":this._handleUsersPushNotificationTemplateGetAck(e.d,e.to);break;case"users.push_notification_template_update.ack":this._handleUsersPushNotificationTemplateUpdateAck(e.d,e.to);break;case"users.push_preference_get.ack":this._handleUsersPushNotificationPreferenceGetAck(e.d,e.to);break;case"users.push_preference_update.ack":this._handleUsersPushNotificationPreferenceUpdateAck(e.d,e.to);break;case"users.push_token_update.ack":this._handleUsersPushTokenUpdateAck(e.d,e.to);break;case"users.push_token_delete.ack":this._handleUsersPushTokenDeleteAck(e.d,e.to);break;case"users.unblock.ack":this._handleUsersUnblockAck(e.d,e.to);break;default:x.getInstance().emit(e.t,e.d)}}_handleAppInfo(e){e.d.ok&&(x.getInstance().app=new u({id:e.d.app.id,name:e.d.app.name,notification:e.d.app.notification,theme:e.d.app.theme}))}_handleGroupChannelInviteAck(e,t){if(e.ok){let n=e.group_channel,s=new C(n);t&&x.getInstance().emit("to."+t+".success",s)}}_handleGroupChannelAcceptAck(e,t){if(e.ok){let n=e.group_channel,s=new C(n);t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelInvitePub(e){if(e.ok){let t=e.group_channel,n=e.users,s=new C(t);for(let e in x.getInstance().getChannelListenersMap()){let t=x.getInstance().getChannelListenersMap()[e];for(let e in n){let r=new _(n[e]);t.onGroupChannelParticipantInvited(s,r)}}}}_handleGroupChannelAcceptPub(e){if(e.ok){let t=e.group_channel,n=e.users,s=new C(t);C._upsert(t);for(let e in n){let t=new _(n[e]);t.id===x.getInstance().user.id&&this._updateTotalGroupChannelCount(s,1,!1);for(let e in x.getInstance().getChannelListenersMap())x.getInstance().getChannelListenersMap()[e].onGroupChannelParticipantJoined(s,t)}}}_handleGroupChannelDeclineAck(e,t){if(e.ok){let n=e.group_channel,s=new C(n);t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelDeclinePub(e){if(e.ok){let t=e.group_channel,n=e.users,s=new C(t);C._upsert(t);for(let e in x.getInstance().getChannelListenersMap()){let t=x.getInstance().getChannelListenersMap()[e];for(let e in n){let r=new _(n[e]);t.onGroupChannelParticipantDeclined(s,r)}}}}_handleGroupChannelLeaveAck(e,t){if(e.ok){let n=e.group_channel,s=new C(n);this._updateTotalGroupChannelCount(s,-1,!1),t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelLeavePub(e){if(e.ok){let t=e.group_channel,n=e.users,s=new C(t);C._upsert(t);for(let e in x.getInstance().getChannelListenersMap()){let t=x.getInstance().getChannelListenersMap()[e];for(let e in n){let r=new _(n[e]);t.onGroupChannelParticipantLeft(s,r)}}}}_handleGroupChannelCreateAck(e,t){if(e.ok){let n=e.group_channel,s=new C(n);t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelHistoryAck(e,t){if(e.ok){let n=e.messages,s=[];for(let e in n){let t=new h(n[e]);s.push(t)}t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelGetAck(e,t){if(e.ok){let n=e.group_channel,s=new C(n);C._upsert(n),t&&x.getInstance().emit("to."+t+".success",s)}else e.error,t&&x.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelUpdatePub(e){if(e.ok){let t=e.group_channel,n=new C(t);C._upsert(t),C.get(n.getId(),function(e,t){for(let e in x.getInstance().getChannelListenersMap())x.getInstance().getChannelListenersMap()[e].onGroupChannelUpdated(t)})}}_handleGroupChannelMyListAck(e,t){if(e.ok){let n=e.group_channels,s=[];for(let e in n){let t=new C(n[e]);s.push(t),C._upsert(n[e])}t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelsMyListCountAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",e.group_channel.count):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelMessageAck(e,t){if(e.ok){let n=e.message,s=new h(n);n.channel_id,t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelMessagePub(e,t){if(e.ok){let t=e.message,n=new h(t),s=t.channel_id,r=!1;C.cachedChannels[s]&&(r=!0);let o=this;C.get(s,function(e,t){r?(t.lastMessage=n,x.getInstance().user.id!==n.user.id&&(t.unreadMessageCount+=1,o._updateTotalUnreadMessageCount(t,1,!1),1===t.unreadMessageCount&&o._updateTotalUnreadGroupChannelCount(t,1,!1)),C.cachedChannels[t.getId()]=t):(o._updateTotalUnreadMessageCount(t,1,!1),1===t.unreadMessageCount&&o._updateTotalUnreadGroupChannelCount(t,1,!1));for(let e in x.getInstance().getChannelListenersMap()){let s=x.getInstance().getChannelListenersMap()[e];s.onGroupChannelMessageReceived(t,n),s.onGroupChannelUpdated(t)}})}}_handleGroupChannelMessageUpdateAck(e,t){if(e.ok){let n=e.message,s=new h(n);n.channel_id,t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelMessageUpdatePub(e,t){if(e.ok){let t=e.message,n=new h(t),s=t.channel_id;C.get(s,function(e,t){for(let e in x.getInstance().getChannelListenersMap())x.getInstance().getChannelListenersMap()[e].onGroupChannelMessageUpdated(t,n)})}}_handleGroupChannelStartTypingPub(e,t){if(e.ok){let t=e.group_channel.typing_participant_id,n=e.group_channel.id;C.get(n,function(e,n){n.setTypingStatus(t,!0);for(let e in x.getInstance().getChannelListenersMap())x.getInstance().getChannelListenersMap()[e].onGroupChannelTypingStatusChanged(n)})}}_handleGroupChannelStopTypingPub(e,t){if(e.ok){let t=e.group_channel.typing_participant_id,n=e.group_channel.id;C.get(n,function(e,n){n.setTypingStatus(t,!1);for(let e in x.getInstance().getChannelListenersMap())x.getInstance().getChannelListenersMap()[e].onGroupChannelTypingStatusChanged(n)})}}_handleGroupChannelReadAck(e,t){if(e.ok){let t=e.group_channel,n=new C(t),s=!1;C.cachedChannels[t.id]&&(s=!0);let r=this;if(s){let e=x.getInstance().user.id,n=C.cachedChannels[t.id];t.read_receipt[e]&&t.read_receipt[e]>=n.lastMessage.insertedAt?(t.unread_message_count=0,r._updateTotalUnreadMessageCount(n,0,!0),n.unreadMessageCount>0&&r._updateTotalUnreadGroupChannelCount(n,-1,!1)):t.unread_message_count=C.cachedChannels[t.id].unreadMessageCount}C._upsert(t),C.get(n.getId(),function(e,t){for(let e in x.getInstance().getChannelListenersMap())x.getInstance().getChannelListenersMap()[e].onGroupChannelUpdated(t)})}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleGroupChannelReadPub(e){if(e.ok){let t=e.group_channel,n=!1;C.cachedChannels[t.id]&&(n=!0);let s=this;if(n){let e=x.getInstance().user.id,n=C.cachedChannels[t.id];t.read_receipt[e]&&t.read_receipt[e]>=n.lastMessage.insertedAt?(t.unread_message_count=0,s._updateTotalUnreadMessageCount(n,0,!0),n.unreadMessageCount>0&&s._updateTotalUnreadGroupChannelCount(n,-1,!1)):t.unread_message_count=C.cachedChannels[t.id].unreadMessageCount,C._upsert(t)}C.get(t.id,function(e,t){for(let e in x.getInstance().getChannelListenersMap())x.getInstance().getChannelListenersMap()[e].onGroupChannelReadStatusUpdated(t)})}}_handleOpenChannelHistoryAck(e,t){if(e.ok){let n=e.messages,s=[];for(let e in n){let t=new h(n[e]);s.push(t)}t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleOpenChannelGetAck(e,t){if(e.ok){let n=e.open_channel,s=new S(n);S._upsert(n),t&&x.getInstance().emit("to."+t+".success",s)}else e.error,t&&x.getInstance().emit("to."+t+".error",e.error)}_handleOpenChannelJoinAck(e,t){if(e.ok){let n=e.open_channel,s=new S(n);t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleOpenChannelJoinPub(e,t){if(e.ok){let t=e.open_channel,n=e.user,s=new S(t),r=new _(n);for(let e in x.getInstance().getChannelListenersMap())x.getInstance().getChannelListenersMap()[e].onOpenChannelParticipantJoined(s,r)}}_handleOpenChannelLeaveAck(e,t){if(e.ok){let n=e.open_channel,s=new S(n);t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleOpenChannelLeavePub(e,t){if(e.ok){let t=e.open_channel,n=e.user,s=new S(t),r=new _(n);for(let e in x.getInstance().getChannelListenersMap())x.getInstance().getChannelListenersMap()[e].onOpenChannelParticipantLeft(s,r)}}_handleOpenChannelListAck(e,t){if(e.ok){let n=e.open_channels,s=[];for(let e in n){let t=new S(n[e]);s.push(t),S._upsert(n[e])}t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleOpenChannelMessageAck(e,t){if(e.ok){let n=e.message,s=new h(n);n.channel_id,t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleOpenChannelMessagePub(e,t){if(e.ok){let t=e.message,n=new h(t),s=t.channel_id;S.get(s,function(e,t){for(let e in x.getInstance().getChannelListenersMap())x.getInstance().getChannelListenersMap()[e].onOpenChannelMessageReceived(t,n)})}}_handleOpenChannelMessageUpdateAck(e,t){if(e.ok){let n=e.message,s=new h(n);n.channel_id,t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleOpenChannelMessageUpdatePub(e,t){if(e.ok){let t=e.message,n=new h(t),s=t.channel_id;S.get(s,function(e,t){for(let e in x.getInstance().getChannelListenersMap())x.getInstance().getChannelListenersMap()[e].onOpenChannelMessageUpdated(t,n)})}}_handleUsersAuthAck(e,t){if(e.ok){this._setUser(e.user),x.getInstance().setConnectionState(R.OPEN),t&&x.getInstance().transportManager._listeners["r_"+t]&&(x.getInstance().transportManager._listeners["r_"+t](null,x.getInstance().user),delete x.getInstance().transportManager._listeners["r_"+t]);for(let e of x.getInstance().connectListeners)e(null,x.getInstance().user);x.getInstance().connectListeners=[];let n=x.getInstance().getConnectionListenersMap();for(let e in n)n[e].onConnectionChanged(!0)}else{t&&x.getInstance().emit("to."+t+".error",e.error);for(let t of x.getInstance().connectListeners)t(new p(e.error),null);x.getInstance().connectListeners=[]}}_handleUsersUpdateAck(e,t){e.ok?e.user.id===x.getInstance().user.id&&(this._setUser(e.user),t&&x.getInstance().emit("to."+t+".success",x.getInstance().user)):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersListAck(e,t){if(e.ok){let n=e.users,s=[];for(let e in n){let t=new l(n[e]);s.push(t)}t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersBlockListAck(e,t){if(e.ok){let n=e.users,s=[];for(let e in n){let t=new l(n[e]);s.push(t)}t&&x.getInstance().emit("to."+t+".success",s)}else t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersBlockAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",new l(e.user)):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersGetTotalUnreadMessageCountAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",e.user.unread_message_count):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersGetTotalUnreadGroupChannelCountAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",e.user.unread_group_channel_count):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersMarkAsReadAllAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",null):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationPreferenceGetAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",e.user):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationPreferenceUpdateAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",null):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationTemplateGetAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",e.user.push_notification_template):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationTemplateUpdateAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",null):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationSnoozeUpdateAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",null):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationSnoozeGetAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",e.user.push_notification_snooze):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationSoundGetAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",e.user.push_notification_sound):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushNotificationSoundUpdateAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",null):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushTokenUpdateAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",x.getInstance().user):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersPushTokenDeleteAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",null):t&&x.getInstance().emit("to."+t+".error",e.error)}_handleUsersUnblockAck(e,t){e.ok?t&&x.getInstance().emit("to."+t+".success",new l(e.user)):t&&x.getInstance().emit("to."+t+".error",e.error)}_setUser(e){x.getInstance().user=new l(e)}_updateTotalUnreadMessageCount(e,t,n=!1){for(let s in x.getInstance().cachedTotalUnreadMessageCount){let{count:r,params:o}=x.getInstance().cachedTotalUnreadMessageCount[s];if(0==o.getCustomFilter().length||!e.getCustomFilter().some(e=>-1===o.getCustomFilter().indexOf(e))){n?x.getInstance().cachedTotalUnreadMessageCount[s].count=0:x.getInstance().cachedTotalUnreadMessageCount[s].count+=t;for(let e in x.getInstance().getUserListenersMap()){let{count:t,params:n}=x.getInstance().cachedTotalUnreadMessageCount[s];x.getInstance().getUserListenersMap()[e].onTotalUnreadMessageCount(t,n)}}}}_updateTotalUnreadGroupChannelCount(e,t,n=!1){for(let s in x.getInstance().cachedTotalUnreadGroupChannelCount){let{count:r,params:o}=x.getInstance().cachedTotalUnreadGroupChannelCount[s];if(0==o.getCustomFilter().length||!e.getCustomFilter().some(e=>-1===o.getCustomFilter().indexOf(e))){n?x.getInstance().cachedTotalUnreadGroupChannelCount[s].count=0:x.getInstance().cachedTotalUnreadGroupChannelCount[s].count+=t;for(let e in x.getInstance().getUserListenersMap()){let{count:t,params:n}=x.getInstance().cachedTotalUnreadGroupChannelCount[s];x.getInstance().getUserListenersMap()[e].onTotalUnreadGroupChannelCount(t,n)}}}}_updateTotalGroupChannelCount(e,t,n=!1){for(let s in C.cachedTotalGroupChannelCount){let{count:r,params:o}=C.cachedTotalGroupChannelCount[s];if(0==o.getCustomFilter().length||!e.getCustomFilter().some(e=>-1===o.getCustomFilter().indexOf(e))){n?C.cachedTotalGroupChannelCount[s].count=0:C.cachedTotalGroupChannelCount[s].count+=t;for(let e in x.getInstance().getChannelListenersMap()){let{count:t,params:n}=C.cachedTotalGroupChannelCount[s];x.getInstance().getChannelListenersMap()[e].onTotalGroupChannelCount(t,n)}}}}};n.d(t,"ClientPushNotificationTemplate",function(){return N}),n.d(t,"ClientConnectionState",function(){return R}),function(e){e.DEFAULT="DEFAULT",e.PRIVATE="PRIVATE"}(N||(N={})),function(e){e[e.OPEN=0]="OPEN",e[e.CONNECTING=1]="CONNECTING",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(R||(R={}));class D extends s{constructor(e){super(e),this.connectionState=R.CLOSED,this.connectListeners=[],this.cachedTotalUnreadGroupChannelCount={},this.baseUrl="https://api.chatcamp.io/api/1.0",c.a.defaults.withCredentials=!0;let t=D.getInstance();if(t)return t;this.channelListeners={},this.connectionListeners={},this.userListeners={},this.cachedTotalUnreadMessageCount={},this.autoReconnectEnabled=!0,this.userForceToDisconnect=!1,this.tick=setInterval(()=>{let e=C.cachedChannels;for(let t in e){if(e[t].checkTypingStatus())for(let n in D.getInstance().getChannelListenersMap()){D.getInstance().getChannelListenersMap()[n].onGroupChannelTypingStatusChanged(e[t])}}},1e3),this.app=new u(e),this.GroupChannel=C,this.OpenChannel=S,this.Message=h,this.MessageParams=d,this.GroupChannelListQuery=f,this.OpenChannelListQuery=v,this.ChannelListener=T,this.ConnectionListener=w,this.UserListener=y,D.instance=this}static getInstance(){return D.instance}connect(){2==arguments.length?"string"==typeof arguments[0]&&(arguments[1],1)&&this.connectUser(arguments[0],arguments[1]):3==arguments.length?"string"==typeof arguments[0]&&"string"==typeof arguments[1]&&(arguments[2],1)?this.connectUserWithAccessToken(arguments[0],arguments[1],arguments[2]):"string"==typeof arguments[0]&&void 0===arguments[1]&&(arguments[2],1)&&this.connectUser(arguments[0],arguments[2]):4==arguments.length?"string"==typeof arguments[0]&&"string"==typeof arguments[1]&&"string"==typeof arguments[2]&&"function"==typeof arguments[3]&&this.customConnectUser(arguments[0],arguments[1],arguments[2],arguments[3]):5==arguments.length&&("string"==typeof arguments[0]&&"string"==typeof arguments[1]&&"string"==typeof arguments[2]&&"string"==typeof arguments[3]&&"function"==typeof arguments[4]?this.customConnectUserWithAccessToken(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]):"string"==typeof arguments[0]&&void 0===arguments[1]&&"string"==typeof arguments[2]&&"string"==typeof arguments[3]&&"function"==typeof arguments[4]&&this.customConnectUser(arguments[0],arguments[2],arguments[3],arguments[4]))}connectUser(e,t){return this._connect({userId:e},t)}connectUserWithAccessToken(e,t,n){return this._connect({userId:e,accessToken:t},n)}customConnectUser(e,t,n,s){return"443"===n?(this.baseUrl="https://"+t+":"+n+"/api/1.0",t="wss://"+t):(this.baseUrl="http://"+t+":"+n+"/api/1.0",t="ws://"+t),this._connect({userId:e,host:t,port:n},s)}customConnectUserWithAccessToken(e,t,n,s,r){return"443"===s?(this.baseUrl="https://"+n+":"+s+"/api/1.0",n="wss://"+n):(this.baseUrl="http://"+n+":"+s+"/api/1.0",n="ws://"+n),this._connect({userId:e,accessToken:t,host:n,port:s},r)}_connect(e,t){if(this.getConnectionState()===R.OPEN)t(null,this.user);else if(this.getConnectionState()==R.CONNECTING)this.connectListeners.push(t);else{let n;this.userForceToDisconnect=!1,n={client:this,app_id:this.app.id,userId:e.userId},e.accessToken&&(n.accessToken=e.accessToken),e.host&&e.port&&(n.host=e.host,n.port=e.port),this.transportManager||(this.transportManager=new P(n)),this.connectListeners.push(t),this.transportManager._connect(n),this.eventManager||(this.eventManager=new G(this,this.transportManager))}}_uploadAttachment(e,t,n,s,r){let o=new FormData;o.append("app_id",this.app.id),o.append("user_id",this.user.id),o.append("channel_type",t),o.append("channel_id",n),o.append("attachment",e),this.user.accessToken&&o.append("user_access_token",this.user.accessToken);let a={headers:{"content-type":"multipart/form-data"},onUploadProgress:e=>{s(e.loaded,e.total)}};c.a.post(this.baseUrl+"/attachment_upload",o,a).then(e=>e.data&&e.data.attachment?r(null,e.data.attachment):r(!0,null)).catch(e=>r(e,null))}getConnectionState(){return this.connectionState}setConnectionState(e){this.connectionState=e}updateUserDisplayName(e,t){return this._updateDisplayNameOnServer(e,t)}updateUserProfileUrl(e,t){return this._updateProfileUrlOnServer(e,t)}updateUserAvatarUrl(e,t){return this._updateAvatarUrlOnServer(e,t)}uploadUserAvatar(e,t,n){let s=new FormData;s.append("app_id",this.app.id),s.append("user_id",this.user.id),this.user.accessToken&&s.append("user_access_token",this.user.accessToken),s.append("avatar",e);let r={headers:{"content-type":"multipart/form-data"},onUploadProgress:e=>{t(e.loaded,e.total)}};c.a.post(this.baseUrl+"/avatar_upload",s,r).then(e=>e.data&&e.data.user?n(null,new l(e.data.user)):n(e.data.error,null)).catch(e=>n(e,null))}updateUserData(e,t){let n={id:this.user.id,data:e};return this._updateUserOnServer(n,t)}updateUserMetadata(e,t){return this._updateMetadataOnServer(e,t)}addChannelListener(e,t){this.channelListeners[e]=t}addConnectionListener(e,t){this.connectionListeners[e]=t}addUserListener(e,t){this.userListeners[e]=t}removeChannelListener(e){delete this.channelListeners[e]}removeConnectionListener(e){delete this.connectionListeners[e]}removeUserListener(e){delete this.userListeners[e]}getChannelListenersMap(){return this.channelListeners}getConnectionListenersMap(){return this.connectionListeners}getUserListenersMap(){return this.userListeners}createUserListQuery(){return new A(b.ALL_USER)}createBlockedUserListQuery(){return new A(b.BLOCKED_USER)}setAutoReconnectEnabled(e){this.autoReconnectEnabled=e}isAutoReconnectEnabled(){return this.autoReconnectEnabled}hasUserForcedDisconnect(){return this.userForceToDisconnect}disconnect(e){this.userForceToDisconnect=!0,this.transportManager.disconnect(e)}blockUser(e,t){let n=this.transportManager.send({t:"users.block",d:{block_id:e}}),s=e=>(window.setTimeout(()=>{D.getInstance().off("to."+n+".success",s),D.getInstance().off("to."+n+".error",r)},0),t(null,e)),r=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+n+".success",s),D.getInstance().off("to."+n+".error",r)},0),t(e,null)};return D.getInstance().on("to."+n+".success",s),D.getInstance().on("to."+n+".error",r),!0}unblockUser(e,t){let n=this.transportManager.send({t:"users.unblock",d:{unblock_id:e}}),s=e=>(window.setTimeout(()=>{D.getInstance().off("to."+n+".success",s),D.getInstance().off("to."+n+".error",r)},0),t(null,e)),r=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+n+".success",s),D.getInstance().off("to."+n+".error",r)},0),t(e,null)};return D.getInstance().on("to."+n+".success",s),D.getInstance().on("to."+n+".error",r),!0}updatePushNotificationTemplate(e,t){let n=this.transportManager.send({t:"users.push_notification_template_update",d:{push_notification_template:e}}),s=()=>(window.setTimeout(()=>{D.getInstance().off("to."+n+".success",s),D.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+n+".success",s),D.getInstance().off("to."+n+".error",r)},0),t(e)};return D.getInstance().on("to."+n+".success",s),D.getInstance().on("to."+n+".error",r),!0}getPushNotificationTemplate(e){let t=this.transportManager.send({t:"users.push_notification_template_get",d:{}}),n=r=>(window.setTimeout(()=>{D.getInstance().off("to."+t+".success",n),D.getInstance().off("to."+t+".error",s)},0),e(null,r)),s=r=>{new p(r);return window.setTimeout(()=>{D.getInstance().off("to."+t+".success",n),D.getInstance().off("to."+t+".error",s)},0),e(r,null)};return D.getInstance().on("to."+t+".success",n),D.getInstance().on("to."+t+".error",s),!0}updatePushNotificationSound(e,t){let n=this.transportManager.send({t:"users.push_notification_sound_update",d:{push_notification_sound:e}}),s=()=>(window.setTimeout(()=>{D.getInstance().off("to."+n+".success",s),D.getInstance().off("to."+n+".error",r)},0),t(null)),r=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+n+".success",s),D.getInstance().off("to."+n+".error",r)},0),t(e)};return D.getInstance().on("to."+n+".success",s),D.getInstance().on("to."+n+".error",r),!0}getPushNotificationSound(e){let t=this.transportManager.send({t:"users.push_notification_sound_get",d:{}}),n=r=>(window.setTimeout(()=>{D.getInstance().off("to."+t+".success",n),D.getInstance().off("to."+t+".error",s)},0),e(null,r)),s=r=>{new p(r);return window.setTimeout(()=>{D.getInstance().off("to."+t+".success",n),D.getInstance().off("to."+t+".error",s)},0),e(r,null)};return D.getInstance().on("to."+t+".success",n),D.getInstance().on("to."+t+".error",s),!0}updatePushNotificationPreference(e,t,n,s,r,o,a){this._updatePushNotificationPreference({doNotDisturb:e,startHour:t,startMin:n,endHour:s,endMin:r,timezone:o},a)}_updatePushNotificationPreference(e,t){let n={t:"users.push_preference_update",d:{dnd:e.doNotDisturb,start_dnd_hour:e.startHour,start_dnd_min:e.startMin,end_dnd_hour:e.endHour,end_dnd_min:e.endMin,timezone:e.timezone}};e.groupChannelId&&(n.d.group_channel_id=e.groupChannelId);let s=this.transportManager.send(n),r=()=>(window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(null)),o=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(e)};return D.getInstance().on("to."+s+".success",r),D.getInstance().on("to."+s+".error",o),!0}getPushNotificationPreference(e){this._getPushNotificationPreference({},e)}_getPushNotificationPreference(e,t){let n={t:"users.push_preference_get",d:{}};e.groupChannelId&&(n.d.group_channel_id=e.groupChannelId);let s=this.transportManager.send(n),r=e=>(window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(null,e.dnd,e.start_dnd_hour,e.start_dnd_min,e.end_dnd_hour,e.end_dnd_min,e.timezone)),o=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(e,null,null,null,null,null,null)};return D.getInstance().on("to."+s+".success",r),D.getInstance().on("to."+s+".error",o),!0}_updateDisplayNameOnServer(e,t){let n={id:this.user.id,display_name:e};return this._updateUserOnServer(n,t)}_updateProfileUrlOnServer(e,t){let n={id:this.user.id,profile_url:e};return this._updateUserOnServer(n,t)}_updateAvatarUrlOnServer(e,t){let n={id:this.user.id,avatar_url:e};return this._updateUserOnServer(n,t)}_updateMetadataOnServer(e,t){let n={id:this.user.id,metadata:e};return this._updateUserOnServer(n,t)}_updateUserOnServer(e,t){let n={t:"users.update",d:e},s=this.transportManager.send(n),r=e=>(window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(null,e)),o=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(e,null)};return D.getInstance().on("to."+s+".success",r),D.getInstance().on("to."+s+".error",o),!0}markAsReadAll(e){let t=this.transportManager.send({t:"users.mark_as_read_all",d:{}}),n=()=>(window.setTimeout(()=>{D.getInstance().off("to."+t+".success",n),D.getInstance().off("to."+t+".error",s)},0),e(null)),s=r=>{new p(r);return window.setTimeout(()=>{D.getInstance().off("to."+t+".success",n),D.getInstance().off("to."+t+".error",s)},0),e(r)};return D.getInstance().on("to."+t+".success",n),D.getInstance().on("to."+t+".error",s),!0}getTotalUnreadMessageCount(e,t){"object"==typeof t?this._getTotalUnreadMessageCount(e,t):this._getTotalUnreadMessageCount(new I,e)}_getTotalUnreadMessageCount(e,t){let n={custom_filter_query_type:e.getCustomFilterQueryType()};e.getCustomFilter().length&&(n.custom_filter=e.getCustomFilter());let s=this.transportManager.send({t:"users.get_total_unread_message_count",d:n}),r=n=>{let a=e.getCustomFilter().join("")+e.getCustomFilterQueryType();return this.cachedTotalUnreadMessageCount[a]={count:n,params:e},window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(null,n,e)},o=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(e,null,null)};return D.getInstance().on("to."+s+".success",r),D.getInstance().on("to."+s+".error",o),!0}getTotalUnreadGroupChannelCount(e,t){"object"==typeof t?this._getTotalUnreadGroupChannelCount(e,t):this._getTotalUnreadGroupChannelCount(new I,e)}_getTotalUnreadGroupChannelCount(e,t){let n={custom_filter_query_type:e.getCustomFilterQueryType()};e.getCustomFilter().length&&(n.custom_filter=e.getCustomFilter());let s=this.transportManager.send({t:"users.get_total_unread_group_channel_count",d:n}),r=n=>{let a=e.getCustomFilter().join("")+e.getCustomFilterQueryType();return this.cachedTotalUnreadGroupChannelCount[a]={count:n,params:e},window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(null,n,e)},o=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(e,null,null)};return D.getInstance().on("to."+s+".success",r),D.getInstance().on("to."+s+".error",o),!0}updatePushNotificationSnooze(e,t){let n=Math.round((new Date).getTime()/1e3),s=this.transportManager.send({t:"users.push_notification_snooze_update",d:{push_notification_snooze:n+60*e}}),r=()=>(window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(null)),o=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+s+".success",r),D.getInstance().off("to."+s+".error",o)},0),t(e)};return D.getInstance().on("to."+s+".success",r),D.getInstance().on("to."+s+".error",o),!0}getPushNotificationSnooze(e){let t=this.transportManager.send({t:"users.push_notification_snooze_get",d:{}}),n=r=>{let o=Math.round((new Date).getTime()/1e3),a=0;return r-o>0&&(a=Math.round((r-o)/60)),window.setTimeout(()=>{D.getInstance().off("to."+t+".success",n),D.getInstance().off("to."+t+".error",s)},0),e(null,a)},s=r=>{new p(r);return window.setTimeout(()=>{D.getInstance().off("to."+t+".success",n),D.getInstance().off("to."+t+".error",s)},0),e(r,null)};return D.getInstance().on("to."+t+".success",n),D.getInstance().on("to."+t+".error",s),!0}updateUserPushToken(e,t,n){let s={push_token_type:t,push_token:e},r=this.transportManager.send({t:"users.push_token_update",d:s}),o=e=>(window.setTimeout(()=>{D.getInstance().off("to."+r+".success",o),D.getInstance().off("to."+r+".error",a)},0),n(null,e)),a=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+r+".success",o),D.getInstance().off("to."+r+".error",a)},0),n(e,null)};return D.getInstance().on("to."+r+".success",o),D.getInstance().on("to."+r+".error",a),!0}deleteUserPushToken(e,t,n){this._deleteUserPushTokenOnServer(e,t,n)}deleteAllUserPushTokens(e){this._deleteUserPushTokenOnServer(e)}_deleteUserPushTokenOnServer(e,t,n){let s={},r=e;"function"==typeof n&&(s={push_token_type:t,push_token:e},r=n);let o=this.transportManager.send({t:"users.push_token_delete",d:s}),a=()=>(window.setTimeout(()=>{D.getInstance().off("to."+o+".success",a),D.getInstance().off("to."+o+".error",i)},0),r(null)),i=e=>{new p(e);return window.setTimeout(()=>{D.getInstance().off("to."+o+".success",a),D.getInstance().off("to."+o+".error",i)},0),r(e)};return D.getInstance().on("to."+o+".success",a),D.getInstance().on("to."+o+".error",i),!0}}var x=t.default=D}])});